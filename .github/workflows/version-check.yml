name: Version Check

on:
  pull_request:
    paths:
      - 'packages/*/package.json'

jobs:
  check-version:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Check version bumps
        run: |
          echo "## 📦 Package Version Changes" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          
          for package in core server openapi client; do
            CURRENT_VERSION=$(node -p "require('./packages/$package/package.json').version")
            echo "- **@richie-rpc/$package**: v$CURRENT_VERSION" >> $GITHUB_STEP_SUMMARY
          done
          
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ⚠️ Reminder" >> $GITHUB_STEP_SUMMARY
          echo "Make sure versions are bumped appropriately:" >> $GITHUB_STEP_SUMMARY
          echo "- **Patch** (0.0.X): Bug fixes" >> $GITHUB_STEP_SUMMARY
          echo "- **Minor** (0.X.0): New features (backwards compatible)" >> $GITHUB_STEP_SUMMARY
          echo "- **Major** (X.0.0): Breaking changes" >> $GITHUB_STEP_SUMMARY

